/* css/console.css - 修复合并消失 bug 版 */

:root {
  --neon-blue: #00f3ff;
  --neon-pink: #ff0055;
  --neon-green: #00ff66;
  --neon-purple: #bc13fe;
  --neon-yellow: #f9f002;
  --console-body: #2f3238;
  --screen-bg: #000;
}

body {
  background-color: #050505;
  display: flex;
  justify-content: center;
  align-items: center;
  min-height: 100vh;
  margin: 0;
  font-family: 'Orbitron', sans-serif;
  overflow: hidden;
  color: #fff;
  perspective: 1000px;
}

/* === 背景层 === */
.bg-stars {
  position: fixed;
  top: 0; left: 0; width: 100%; height: 60%;
  background: radial-gradient(ellipse at bottom, #1b2735 0%, #090a0f 100%);
  z-index: 0;
}
.bg-stars::after {
  content: "";
  position: absolute;
  top: 0; left: 0; width: 100%; height: 100%;
  background-image: 
    radial-gradient(2px 2px at 20px 30px, #eee, rgba(0,0,0,0)),
    radial-gradient(2px 2px at 40px 70px, #fff, rgba(0,0,0,0)),
    radial-gradient(2px 2px at 50px 160px, #ddd, rgba(0,0,0,0)),
    radial-gradient(2px 2px at 90px 40px, #fff, rgba(0,0,0,0)),
    radial-gradient(2px 2px at 130px 80px, #fff, rgba(0,0,0,0));
  background-size: 200px 200px;
  opacity: 0.4;
}

.retro-floor {
  position: fixed;
  bottom: 0; left: -50%; width: 200%; height: 50%;
  background: 
    linear-gradient(rgba(0, 243, 255, 0.2) 1px, transparent 1px),
    linear-gradient(90deg, rgba(0, 243, 255, 0.2) 1px, transparent 1px);
  background-size: 60px 60px;
  background-position: center bottom;
  transform: rotateX(60deg);
  transform-origin: center top;
  animation: floor-move 10s linear infinite;
  z-index: 0;
  -webkit-mask-image: linear-gradient(to bottom, rgba(0,0,0,0) 0%, rgba(0,0,0,1) 40%);
  mask-image: linear-gradient(to bottom, rgba(0,0,0,0) 0%, rgba(0,0,0,1) 40%);
}

@keyframes floor-move {
  from { background-position: 0 0; }
  to { background-position: 0 60px; }
}

/* === 游戏机容器 === */
.console-wrapper {
  position: relative;
  width: 400px; height: 700px;
  z-index: 10;
  transform: scale(1.15); 
  transform-origin: center center;
  border-radius: 40px;
  box-shadow: 
    0 0 0 1px #333,
    0 0 40px rgba(0, 243, 255, 0.2),
    0 0 80px rgba(0, 0, 0, 0.8);
}

@media (max-height: 850px) { .console-wrapper { transform: scale(0.9); } }
@media (max-height: 700px) { .console-wrapper { transform: scale(0.75); } }

.console-bg {
  position: absolute; top: 0; left: 0; width: 100%; height: 100%;
  z-index: 1; pointer-events: none;
  filter: drop-shadow(0px 5px 10px rgba(0,0,0,0.8));
}

/* === 屏幕层 === */
.screen-layer {
  position: absolute;
  top: 55px; left: 35px;
  width: 330px; height: 360px; 
  background-color: #000; 
  z-index: 2;
  border: 2px solid #333;
  display: flex;
  flex-direction: column;
  align-items: center;
  overflow: hidden;
}

.header-info {
  display: flex; width: 100%; justify-content: space-between;
  padding: 15px 20px; box-sizing: border-box;
  font-size: 16px; 
  color: var(--neon-blue);
  border-bottom: 1px solid #222;
  margin-bottom: 10px;
}
.header-info .value { font-weight: bold; color: #fff; margin-left: 5px; font-size: 20px; }

/* === 核心游戏区域 === */
main {
  margin-top: 5px !important;
  width: 290px !important;
  height: 290px !important;
  background: transparent !important;
  padding: 0 !important;
  position: relative;
  margin-left: auto; margin-right: auto;
}

/* 背景空格子 */
.grid-bg-cell {
  position: absolute;
  background: rgba(255, 255, 255, 0.02);
  border: 1px solid rgba(255, 255, 255, 0.05);
  border-radius: 6px;
  z-index: 1;
}

/* Tile 方块容器 */
main .tile-container .tile {
  position: absolute;
  z-index: 2;
  transition: transform 100ms ease-in-out;
}

/* Tile 内部样式 - 五彩斑斓的黑 */
main .tile-container .tile-inner {
  width: 100%; height: 100%;
  display: flex; justify-content: center; align-items: center;
  font-weight: bold; 
  font-family: 'Orbitron', sans-serif;
  border-radius: 6px;
  border: 2px solid; 
  box-sizing: border-box;
  background-color: rgba(0,0,0,0.5); 
  color: #fff;
  box-shadow: inset 0 0 10px rgba(255,255,255,0.05);
}

.tile-font-small { font-size: 16px !important; }
.tile-font-medium { font-size: 24px !important; }
.tile-font-large { font-size: 32px !important; }

/* === 配色方案 === */
main .tile-container .tile.tile-2 .tile-inner { border-color: var(--neon-blue); color: var(--neon-blue); background: rgba(0, 243, 255, 0.15); box-shadow: 0 0 5px rgba(0, 243, 255, 0.2); }
main .tile-container .tile.tile-4 .tile-inner { border-color: var(--neon-green); color: var(--neon-green); background: rgba(0, 255, 102, 0.15); box-shadow: 0 0 5px rgba(0, 255, 102, 0.2); }
main .tile-container .tile.tile-8 .tile-inner { border-color: var(--neon-pink); color: var(--neon-pink); background: rgba(255, 0, 85, 0.15); box-shadow: 0 0 5px rgba(255, 0, 85, 0.2); }
main .tile-container .tile.tile-16 .tile-inner { border-color: var(--neon-yellow); color: var(--neon-yellow); background: rgba(249, 240, 2, 0.15); box-shadow: 0 0 5px rgba(249, 240, 2, 0.2); }
main .tile-container .tile.tile-32 .tile-inner { border-color: var(--neon-purple); color: var(--neon-purple); background: rgba(188, 19, 254, 0.15); box-shadow: 0 0 5px rgba(188, 19, 254, 0.2); }
main .tile-container .tile.tile-64 .tile-inner { border-color: #ff8800; color: #ff8800; background: rgba(255, 136, 0, 0.15); box-shadow: 0 0 5px rgba(255, 136, 0, 0.2); }
main .tile-container .tile.tile-128 .tile-inner, 
main .tile-container .tile.tile-256 .tile-inner,
main .tile-container .tile.tile-512 .tile-inner { border-color: #fff; color: #fff; background: rgba(255,255,255,0.2); box-shadow: 0 0 10px rgba(255,255,255,0.3); }
main .tile-container .tile.tile-1024 .tile-inner,
main .tile-container .tile.tile-2048 .tile-inner { border-color: gold; color: gold; background: rgba(255, 215, 0, 0.2); box-shadow: 0 0 15px gold; }

/* === 动画修复核心部分 === */

/* 1. 出现动画 - 使用 neon-appear 防止冲突 */
.tile-new .tile-inner {
  animation: neon-appear 200ms ease 100ms;
  animation-fill-mode: backwards;
}

/* 2. 合并动画 - 使用 neon-pop 防止冲突，并加 !important 提高权重 */
/* 增加选择器权重：main .tile-container ... */
main .tile-container .tile-merged .tile-inner {
  z-index: 20;
  /* 关键修改：重命名动画为 neon-pop，彻底避开 main.css 的 pop */
  animation: neon-pop 200ms cubic-bezier(0.175, 0.885, 0.32, 1.275) 100ms !important;
  animation-fill-mode: backwards !important;
}

@keyframes neon-appear {
  0% { opacity: 0; transform: scale(0); }
  100% { opacity: 1; transform: scale(1); }
}

@keyframes neon-pop {
  0% { transform: scale(1); } /* 起始是原大，不是0！ */
  50% { transform: scale(1.25); }
  100% { transform: scale(1); }
}

/* === 菜单与控制层 === */
.mask { 
  background-color: rgba(0, 0, 0, 0.95) !important; 
  backdrop-filter: blur(2px); 
  position: absolute; top: 0; left: 0; right: 0; bottom: 0;
  display: flex; flex-direction: column; justify-content: center; align-items: center;
  z-index: 50;
}
.mask.status .content { color: var(--neon-pink); font-size: 32px; font-family: 'Orbitron', sans-serif; }
.press-start { color: var(--neon-blue); animation: blink 3s infinite; margin-top: 20px; font-size: 18px; }

.start-menu { display: flex; background-color: rgba(0,0,0,0.95) !important; }
.menu-title { font-size: 24px; color: var(--neon-blue); margin-bottom: 30px; letter-spacing: 2px; }
.menu-options { display: flex; flex-direction: column; gap: 15px; }
.menu-opt {
  position: relative; appearance: none;
  background: rgba(0, 243, 255, 0.05);
  border: 1px solid var(--neon-blue);
  color: #fff; padding: 10px 30px;
  font-family: 'Orbitron', sans-serif; font-size: 18px;
  cursor: pointer; transition: all 0.2s;
  text-transform: uppercase; width: 200px; text-align: center;
}
.menu-opt:hover, .menu-opt:active { background: var(--neon-blue); color: #000; box-shadow: 0 0 10px var(--neon-blue); }

.controls-layer { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 10; border-radius: 40px; pointer-events: none; }
button { appearance: none; -webkit-appearance: none; border: none; background: transparent; padding: 0; margin: 0; position: absolute; outline: none; cursor: pointer; -webkit-tap-highlight-color: transparent; pointer-events: auto; }

.d-pad { width: 45px; height: 45px; }
.d-pad.up    { top: 465px; left: 118px; width: 44px; height: 44px; }
.d-pad.down  { top: 551px; left: 118px; width: 44px; height: 44px; }
.d-pad.left  { top: 508px; left: 75px;  width: 44px; height: 44px; }
.d-pad.right { top: 508px; left: 161px; width: 44px; height: 44px; }

.action-btn {
  width: 60px; height: 60px; border-radius: 50%;
  font-weight: bold; font-size: 20px; line-height: 56px; text-align: center;
  border: 2px solid; background: rgba(0, 0, 0, 0.5); transition: transform 0.1s;
}
.action-btn:active { transform: scale(0.9); background: rgba(0, 0, 0, 0.8); }
.btn-a { top: 500px; left: 290px; color: var(--neon-green); border-color: var(--neon-green); box-shadow: 0 0 5px rgba(0, 255, 102, 0.2); }
.btn-b { top: 540px; left: 220px; color: var(--neon-pink); border-color: var(--neon-pink); box-shadow: 0 0 5px rgba(255, 0, 85, 0.2); }

.menu-btn { width: 60px; height: 30px; transform: rotate(25deg); }
.menu-btn.select { top: 622px; left: 130px; }
.menu-btn.start { top: 622px; left: 210px; }

@keyframes blink { 50% { opacity: 0; } }

.rank-btn {
  position: fixed;
  height:34px;
  width:70px;
  bottom: 40px; /* <-- 改成 bottom，按钮就会去下面 */
  right: 40px;
  z-index: 9999; /* 建议改大一点，确保浮在所有图层上面 */
  padding: 8px 14px;
  background: rgba(0, 243, 255, 0.15);
  border: 1px solid #00f3ff;
  color: #00f3ff;
  text-decoration: none;
  font-family: 'Orbitron', sans-serif;
  font-size: 18px;
  text-align: center;
  line-height: 34px;
  border-radius: 8px;
  backdrop-filter: blur(4px); /* 加上模糊效果更好看 */
}
.rank-btn:hover {
  background: #00f3ff;
  color: #000;
}

.game-over-score {
  margin-top: 12px;
  font-size: 18px;
  color: #00f3ff;
  letter-spacing: 1px;
}

.game-over-record {
  margin-top: 6px;
  font-size: 20px;
  color: var(--neon-yellow);
  letter-spacing: 2px;
  text-shadow: 0 0 10px var(--neon-yellow);
  animation: blink 1.5s infinite;
}

.logout-btn {
  position: fixed;
  height: 34px;
  width: 105px;
  bottom: 40px;
  left: 40px;
  z-index: 9999;
  text-align: center;
  background: rgba(255, 0, 85, 0.15);
  border: 1px solid #ff0055;
  color: #ff0055;

  font-family: 'Orbitron', sans-serif;
  font-size: 18px;
  border-radius: 8px;
  cursor: pointer;
  backdrop-filter: blur(4px);
  pointer-events: auto;
}

.logout-btn:hover {
  background: #ff0055;
  color: #000;
}


/* === console.css 底部修复代码 === */

/* 1. 胜利/失败 按钮容器 */
.win-actions {
  margin-top: 20px;
  display: flex; /* 配合 JS 的 display: flex 使用 */
  justify-content: center;
  align-items: center;
  gap: 16px;
  z-index: 100; /* 确保容器在最上层 */
  position: relative; /* 让 z-index 生效 */
}

/* 2. 胜利/失败 按钮样式 */
.win-actions button {
  /* 强制覆盖全局 button 样式 */
  position: relative !important; /* 关键：使用 relative 支持 z-index，且不脱离文档流 */
  z-index: 101 !important;       /* 关键：确保比 Mask 背景高 */

  /* 视觉样式 */
  appearance: none;
  padding: 10px 22px;
  font-family: 'Orbitron', sans-serif;
  font-size: 14px;
  font-weight: bold;
  letter-spacing: 2px;
  cursor: pointer;

  /* 强制显色 */
  background-color: rgba(0, 243, 255, 0.15) !important;
  border: 1px solid #00f3ff !important;
  color: #00f3ff !important;
  border-radius: 6px;
  box-shadow: 0 0 10px rgba(0, 243, 255, 0.1);

  transition: all 0.2s ease;
}

/* 3. 按钮悬停效果 */
.win-actions button:hover {
  background-color: #00f3ff !important;
  color: #000 !important;
  box-shadow: 0 0 20px rgba(0, 243, 255, 0.8);
  transform: scale(1.05);
}

/* 4. 点击效果 */
.win-actions button:active {
  transform: scale(0.95);
}

/* 默认失败态 */
#status-text.failure {
  color: #ff0055;
  font-size: 32px;
  font-weight: bold;
  text-shadow: 0 0 10px #ff0055;
  letter-spacing: normal;
}

/* 胜利态 */
#status-text.win {
  color: #f9f002;
  font-size: 40px;
  font-weight: 800;
  text-shadow: 0 0 20px #f9f002;
  letter-spacing: 2px;
}




