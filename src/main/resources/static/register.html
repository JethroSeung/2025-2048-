<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cyber2048 注册</title>
    <!-- 引入新写的样式 -->
    <link rel="stylesheet" href="./css/auth.css">
</head>
<body>

<div class="auth-container">
    <h2>REGISTRATION</h2>

    <input id="username" placeholder="SET USERNAME" />
    <br><br>
    <input id="password" type="password" placeholder="SET PASSWORD" />
    <br><br>

    <button onclick="register()">Confirm Identity</button>
    <button onclick="back()">Abort / Back</button>
</div>

<script>
    function register() {
        const username = document.getElementById('username').value.trim();
        const password = document.getElementById('password').value.trim();

        if (!username || !password) {
            alert('用户名和密码不能为空');
            return;
        }

        fetch('/api/user/register', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ username, password })
        })
            .then(res => res.json())
            .then(res => {
                if (res.code === 0) {
                    alert('注册成功，请登录');
                    location.href = 'login.html';
                } else {
                    alert(res.msg || '注册失败 用户名已存在');
                }
            })
            .catch(() => {
                alert('网络错误');
            });
    }

    function back() {
        location.href = 'login.html';
    }
</script>
</body>
</html>